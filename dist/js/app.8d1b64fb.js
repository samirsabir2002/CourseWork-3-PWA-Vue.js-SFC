(function(){"use strict";var e={5887:function(e,t,o){var r=o(5130),s=o(6768),a=o(4232);const n={class:"navbar bg-white shadow"},l={class:"container"},i=["textContent"],c=(0,s.Lk)("i",{class:"fa-solid fa-cart-shopping fs-6"},null,-1),d={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},u=(0,s.Lk)("span",{class:"visually-hidden"},"Cart items",-1),p={key:0,class:"container my-5"},h=(0,s.Lk)("h2",null,"Lessons",-1),m={class:"row align-items-center mb-3"},f={class:"col-md-3"},v=(0,s.Lk)("option",{value:"subject"},"Subject",-1),k=(0,s.Lk)("option",{value:"location"},"Location",-1),b=(0,s.Lk)("option",{value:"price"},"Price",-1),L=(0,s.Lk)("option",{value:"availability"},"Availability",-1),g=[v,k,b,L],y={class:"col-md-3"},C=(0,s.Lk)("option",{value:"asc"},"Ascending",-1),w=(0,s.Lk)("option",{value:"desc"},"Descending",-1),x=[C,w],j={class:"col-md-6 d-flex align-items-center"},P={class:"input-group"},O={key:1},F={key:2,class:"cart"};function E(e,t,o,v,k,b){const L=(0,s.g2)("LessonComponent"),C=(0,s.g2)("CheckoutForm");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("header",null,[(0,s.Lk)("nav",n,[(0,s.Lk)("div",l,[(0,s.Lk)("a",{class:"navbar-brand fw-bolder text-primary",href:"#",textContent:(0,a.v_)(k.sitename)},null,8,i),(0,s.Lk)("button",{onClick:t[0]||(t[0]=e=>b.toggleCheckout()),type:"button",class:"btn btn-primary position-relative","data-mdb-ripple-init":""},[c,(0,s.Lk)("span",d,[(0,s.eW)((0,a.v_)(k.cart.length)+" ",1),u])])])])]),k.showProduct?((0,s.uX)(),(0,s.CE)("div",p,[(0,s.Lk)("div",null,[h,(0,s.Lk)("div",m,[(0,s.Lk)("div",f,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>k.sortBy=e),class:"form-select form-select-sm"},g,512),[[r.u1,k.sortBy]])]),(0,s.Lk)("div",y,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>k.sortOrder=e),class:"form-select form-select-sm"},x,512),[[r.u1,k.sortOrder]])]),(0,s.Lk)("div",j,[(0,s.Lk)("div",P,[(0,s.bo)((0,s.Lk)("input",{type:"text",onKeyup:t[3]||(t[3]=e=>b.Searching()),"onUpdate:modelValue":t[4]||(t[4]=e=>k.search=e),placeholder:"Search Lesson",id:"search-input",class:"form-control form-control-sm","aria-describedby":"searchButton"},null,544),[[r.Jo,k.search]])])])])])])):(0,s.Q3)("",!0),k.showProduct?((0,s.uX)(),(0,s.CE)("div",O,[(0,s.bF)(L,{"show-product":k.showProduct,"cart-count":b.cartCount,lessons:b.filteredLessons,"can-add-to-cart":b.canAddToCart,onAddToCart:b.addToCart},null,8,["show-product","cart-count","lessons","can-add-to-cart","onAddToCart"])])):((0,s.uX)(),(0,s.CE)("div",F,[(0,s.bF)(C,{"cart-count":b.cartCount,"save-order":b.saveOrder,onRemoveItemFromCart:b.removeFromCart,cart:k.cart,"showhome-page-btn":b.showhomePageBtn},null,8,["cart-count","save-order","onRemoveItemFromCart","cart","showhome-page-btn"])]))])}o(4114);const A=e=>((0,s.Qi)("data-v-73433c8a"),e=e(),(0,s.jt)(),e),I={class:"container my-5"},T={class:"row d-flex justify-content-center align-items-center"},q={class:"col"},S={class:"card"},_={class:"card-body p-4"},U={class:"row"},X={class:"col-lg-7"},B={class:"mb-3"},N=A((()=>(0,s.Lk)("i",{class:"fas fa-long-arrow-alt-left me-2"},null,-1))),V=A((()=>(0,s.Lk)("hr",null,null,-1))),$={key:0},D={class:"d-flex justify-content-between align-items-center mb-4"},J=A((()=>(0,s.Lk)("p",{class:"mb-1"},"Shopping cart",-1))),K={class:"mb-0"},Q={class:"card mb-3"},R={class:"card-body"},W={class:"d-flex justify-content-between"},Y={class:"d-flex flex-row align-items-center"},G=["src"],M={class:"ms-3"},z={class:"d-flex flex-row align-items-center"},H={style:{width:"50px"}},Z={class:"fw-normal mb-0"},ee={style:{width:"80px"}},te={class:"mb-0"},oe=["onClick"],re=A((()=>(0,s.Lk)("i",{class:"fas fa-trash-alt"},null,-1))),se=[re],ae={key:1},ne=A((()=>(0,s.Lk)("p",null,"Your cart is empty.",-1))),le=[ne],ie={class:"col-lg-5"},ce={class:"card bg-primary text-white rounded-3"},de={class:"card-body"},ue=A((()=>(0,s.Lk)("div",{class:"d-flex justify-content-between align-items-center mb-4"},[(0,s.Lk)("h5",{class:"mb-0"},"User details"),(0,s.Lk)("div",{class:"bg-white rounded"},[(0,s.Lk)("img",{src:"Images/visualhunter-1d714a7743.png",class:"img-fluid rounded-3",style:{width:"45px"},alt:"Avatar"})])],-1))),pe={class:"mt-4"},he={key:0,class:"text-danger"},me=A((()=>(0,s.Lk)("label",{class:"form-label text-white",for:"firstNameInput"},"First Name",-1))),fe=A((()=>(0,s.Lk)("label",{class:"form-label text-white",for:"phoneInput"},"Phone Number",-1))),ve=A((()=>(0,s.Lk)("hr",{class:"my-4"},null,-1))),ke={class:"d-flex justify-content-between mb-4"},be=A((()=>(0,s.Lk)("p",{class:"mb-2"},"Total (Incl. taxes)",-1))),Le={class:"mb-2"},ge=["disabled"],ye={class:"d-flex justify-content-between"},Ce=A((()=>(0,s.Lk)("span",null,[(0,s.eW)(" Checkout "),(0,s.Lk)("i",{class:"fas fa-long-arrow-alt-right ms-2"})],-1))),we={class:"modal fade",id:"placeordermodal",tabindex:"-1","aria-labelledby":"placeordermodalLabel","aria-hidden":"true"},xe={class:"modal-dialog"},je={class:"modal-content"},Pe=A((()=>(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h5",{class:"modal-title",id:"placeordermodalLabel"},"Order Confirmation"),(0,s.Lk)("button",{type:"button",class:"btn-close","data-mdb-dismiss":"modal","aria-label":"Close"})],-1))),Oe=A((()=>(0,s.Lk)("div",{class:"modal-body"},"Order Confirmed Successfully",-1))),Fe={class:"modal-footer"};function Ee(e,t,o,n,l,i){return(0,s.uX)(),(0,s.CE)("section",null,[(0,s.Lk)("div",I,[(0,s.Lk)("div",T,[(0,s.Lk)("div",q,[(0,s.Lk)("div",S,[(0,s.Lk)("div",_,[(0,s.Lk)("div",U,[(0,s.Lk)("div",X,[(0,s.Lk)("h5",B,[(0,s.Lk)("a",{href:"#!",class:"text-body",onClick:t[0]||(t[0]=(...e)=>o.showhomePageBtn&&o.showhomePageBtn(...e))},[N,(0,s.eW)(" Continue shopping ")])]),V,o.cart.length?((0,s.uX)(),(0,s.CE)("div",$,[(0,s.Lk)("div",D,[(0,s.Lk)("div",null,[J,(0,s.Lk)("p",K,"You have "+(0,a.v_)(i.CartItemCount)+" items in your cart",1)])]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.groupedCart,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id},[(0,s.Lk)("div",Q,[(0,s.Lk)("div",R,[(0,s.Lk)("div",W,[(0,s.Lk)("div",Y,[(0,s.Lk)("div",null,[(0,s.Lk)("img",{src:i.ServerImage(e.picture),class:"img-fluid rounded-3",alt:"Shopping item",style:{width:"65px"}},null,8,G)]),(0,s.Lk)("div",M,[(0,s.Lk)("h5",null,(0,a.v_)(e.subject),1)])]),(0,s.Lk)("div",z,[(0,s.Lk)("div",H,[(0,s.Lk)("h5",Z,(0,a.v_)(e.quantity),1)]),(0,s.Lk)("div",ee,[(0,s.Lk)("h5",te,(0,a.v_)((e.price*e.quantity).toFixed(2))+" AED",1)]),(0,s.Lk)("a",{onClick:t=>i.removeFromCart(e.id),href:"#!",style:{color:"#cecece"}},se,8,oe)])])])])])))),128))])):((0,s.uX)(),(0,s.CE)("div",ae,le))]),(0,s.Lk)("div",ie,[(0,s.Lk)("div",ce,[(0,s.Lk)("div",de,[ue,(0,s.Lk)("form",pe,[l.isFormValid?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("p",he,"Please fill in all fields.")),me,(0,s.bo)((0,s.Lk)("input",{type:"text",id:"firstNameInput",class:"form-control form-control-lg",placeholder:"First Name","onUpdate:modelValue":t[1]||(t[1]=e=>l.order.firstName=e),required:""},null,512),[[r.Jo,l.order.firstName,void 0,{trim:!0}]]),fe,(0,s.bo)((0,s.Lk)("input",{type:"tel",id:"phoneInput",class:"form-control form-control-lg","onUpdate:modelValue":t[2]||(t[2]=e=>l.order.phone=e),required:"",placeholder:"Phone Number"},null,512),[[r.Jo,l.order.phone,void 0,{number:!0}]])]),ve,(0,s.Lk)("div",ke,[be,(0,s.Lk)("p",Le,"AED "+(0,a.v_)(i.cartTotal),1)]),(0,s.Lk)("button",{disabled:!l.isFormValid,"data-mdb-ripple-init":"","data-mdb-modal-init":"",type:"button","data-mdb-toggle":"modal","data-mdb-target":"#placeordermodal",class:"btn btn-info btn-block btn-lg",onClick:t[3]||(t[3]=(...e)=>i.submitOrder&&i.submitOrder(...e))},[(0,s.Lk)("div",ye,[(0,s.Lk)("span",null,"AED "+(0,a.v_)(i.cartTotal),1),Ce])],8,ge)])])])])])])]),(0,s.Lk)("div",we,[(0,s.Lk)("div",xe,[(0,s.Lk)("div",je,[Pe,Oe,(0,s.Lk)("div",Fe,[(0,s.Lk)("button",{type:"button",class:"btn btn-primary","data-mdb-dismiss":"modal",onClick:t[4]||(t[4]=(...e)=>o.showhomePageBtn&&o.showhomePageBtn(...e))},"Close")])])])])])])])}var Ae={name:"CheckoutForm",props:{cart:{type:Array,required:!0},saveOrder:{type:Function,required:!0},showhomePageBtn:{type:Function,required:!0}},data(){return{order:{firstName:"",phone:""},isFormValid:!1}},watch:{order:{handler(){this.validateForm()},deep:!0}},computed:{groupedCart(){let e={};return this.cart.forEach((t=>{e[t.id]||(e[t.id]={...t,quantity:0}),e[t.id].quantity+=1})),console.log("ðŸš€ ~this.cart:",Object.values(e)),Object.values(e)},cartTotal(){return this.groupedCart.reduce(((e,t)=>e+t.price*t.quantity),0).toFixed(2)},CartItemCount(){return this.cart.length}},methods:{ServerImage(e){const t="https://coursework-2-after-school.onrender.com",o=e.split("/").pop().trim(),r=t+"/"+o;return r},validateForm(){this.isFormValid=!!this.order.firstName&&!!this.order.phone},submitOrder(){this.isFormValid&&(this.order.lessonItems=this.groupedCart.map((e=>({id:e._id,quantity:e.quantity}))),this.saveOrder(this.order))},CartCount(e){this.$emit("cart-count",e)},removeFromCart(e){this.$emit("remove-item-from-cart",e)},itemTotalPrice(e){return(e.price*e.availability).toFixed(2)},getImageUrl(e){return e.picture||"path/to/your/fallback/image.png"}}},Ie=o(1241);const Te=(0,Ie.A)(Ae,[["render",Ee],["__scopeId","data-v-73433c8a"]]);var qe=Te;const Se={key:0,class:"container"},_e={class:"row justify-content-evenly"},Ue={class:"my-3 col-sm-6 col-lg-4 w-100"},Xe={class:"card border-0 rounded shadow"},Be=["src"],Ne={class:"card-body mt-3 mb-3"},Ve={class:"row"},$e={class:"col-12"},De={class:"card-title"},Je=(0,s.Lk)("span",{class:"fw-bold"},"Subject:",-1),Ke={class:"card-text"},Qe=(0,s.Lk)("span",{class:"fw-bold"},"Description:",-1),Re={class:""},We={class:"col-12"},Ye=(0,s.Lk)("span",{class:"fw-bold"},"Location:",-1),Ge={class:"col-12"},Me=(0,s.Lk)("span",{class:"fw-bold"},"Available Inventory:",-1),ze={class:"row align-items-center text-start g-0"},He={class:"col-12"},Ze=(0,s.Lk)("span",{class:"fw-bold"},"Price:",-1),et={class:"row"},tt={class:"col-12 d-grid gap-2 mx-auto"},ot=["onClick"],rt=["disabled","onClick"],st={key:1,class:"col-12 d-flex justify-content-center my-5"},at=(0,s.Lk)("div",{class:"spinner-grow text-primary",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"Loading...")],-1),nt=[at],lt=(0,s.Lk)("div",null,null,-1);function it(e,t,o,r,n,l){return(0,s.uX)(),(0,s.CE)(s.FK,null,[o.lessons.length?((0,s.uX)(),(0,s.CE)("div",Se,[(0,s.Lk)("div",_e,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.lessons,((t,r)=>((0,s.uX)(),(0,s.CE)("div",{key:r,class:"my-3 col-sm-6 col-lg-4"},[(0,s.Lk)("div",Ue,[(0,s.Lk)("div",Xe,[(0,s.Lk)("img",{src:l.ServerImage(t.picture),class:"card-img-top rounded",alt:"..."},null,8,Be),(0,s.Lk)("div",Ne,[(0,s.Lk)("div",Ve,[(0,s.Lk)("div",$e,[(0,s.Lk)("p",De,[Je,(0,s.Lk)("span",null,(0,a.v_)(t.subject),1)]),(0,s.Lk)("p",Ke,[Qe,(0,s.Lk)("span",Re,(0,a.v_)(t.description),1)])]),(0,s.Lk)("div",We,[Ye,(0,s.Lk)("span",null,(0,a.v_)(t.location),1)]),(0,s.Lk)("div",Ge,[Me,(0,s.Lk)("span",null,(0,a.v_)(t.availability),1)])]),(0,s.Lk)("div",ze,[(0,s.Lk)("div",He,[Ze,(0,s.Lk)("span",null,(0,a.v_)(t.price)+" AED",1)])]),(0,s.Lk)("div",et,[(0,s.Lk)("div",tt,[o.canAddToCart(t)?((0,s.uX)(),(0,s.CE)("a",{key:0,onClick:e=>l.addToCart(t),href:"#",class:"btn btn-primary","data-mdb-ripple-init":"","aria-pressed":"false"}," ADD TO CART ",8,ot)):((0,s.uX)(),(0,s.CE)("a",{key:1,disabled:0===t.availability,onClick:o=>e.AddToCartBtn(t),href:"#",class:"btn btn-primary disabled","data-mdb-ripple-init":""}," Out Of Stock! ",8,rt))])])])])])])))),128))])])):((0,s.uX)(),(0,s.CE)("div",st,nt)),lt],64)}var ct={name:"LessonComponent",props:{lessons:{type:Array,required:!0},canAddToCart:{type:Function,required:!0},cartCount:{type:Function,required:!0},showProduct:{type:Boolean,required:!0}},data(){return{}},computed:{},methods:{addToCart(e){this.$emit("add-to-cart",e)},ServerImage(e){const t="https://coursework-2-after-school.onrender.com",o=e.split("/").pop().trim(),r=t+"/"+o;return r}}};const dt=(0,Ie.A)(ct,[["render",it]]);var ut=dt,pt={name:"App",components:{CheckoutForm:qe,LessonComponent:ut},data(){return{sitename:"After School Activities",products:[],cart:[],search:"",showProduct:!0,sortBy:"subject",sortOrder:"asc",ascendingOrder:!0,baseUrl:"https://coursework-2-after-school.onrender.com",showInstallPrompt:!1,deferredPrompt:null}},created(){this.fetchLessons(),window.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),this.deferredPrompt=e,this.showInstallPrompt=!0}))},methods:{fetchLessons(){fetch(`${this.baseUrl}/collection/products`).then((e=>e.json())).then((e=>{this.products=e})).catch((e=>{console.error("Error fetching lessons:",e)}))},saveOrder(e){console.log(e),fetch(`${this.baseUrl}/collection/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{console.log("ðŸš€ ~ ProcessOrder ~ resjson:",e)})),console.log(e["lessonItems"]),e["lessonItems"].forEach((e=>{this.UpdateProduct(e.id,e.quantity)})),this.cart=[],this.name="",this.phone=""},UpdateProduct(e,t){fetch(`${this.baseUrl}/collection/products/${e}/reduce/availableSpace/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",mode:"no-cors"}}).then((e=>e.json())).then((e=>console.log("ðŸš€ ~ UpdateProduct ~ resjson:",e)))},addToCart(e){if(this.canAddToCart(e)){const t=this.products.findIndex((t=>t.id===e.id));-1!==t&&(this.products[t].availability--,this.cart.push({...e}))}},canAddToCart(e){return e.availability>this.cartCount(e.id)&&e.availability>0},cartCount(e){let t=this.cart.find((t=>t.id===e.id));return t?t.quantity:0},toggleCheckout(){this.showProduct=!this.showProduct},removeFromCart(e){const t=this.cart.findIndex((t=>t.id===e));if(-1!==t){const o=this.products.findIndex((t=>t.id===e));-1!==o&&this.products[o].availability++,this.cart.splice(t,1)}},promptInstall(){this.deferredPrompt&&(this.deferredPrompt.prompt(),this.deferredPrompt.userChoice.then((e=>{"accepted"===e.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt"),this.deferredPrompt=null,this.showInstallPrompt=!1})))},Searching(){let e=this.search.toLowerCase();fetch(`${this.baseUrl}/collection/products/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}).then((e=>e.json())).then((e=>{this.products=e})).catch((e=>{console.error("Error fetching lessons:",e)}))},showhomePageBtn:function(){try{fetch(`${this.baseUrl}/collection/products`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{this.products=e})).catch((e=>{console.error("Error fetching lessons:",e)})),this.toggleCheckout()}catch(e){console.error("ðŸš€ ~ ex:",e)}}},computed:{filteredLessons(){let e=[...this.products];return e.sort(((e,t)=>{let o=0;switch(this.sortBy){case"subject":o=e.subject.localeCompare(t.subject);break;case"location":o=e.location.localeCompare(t.location);break;case"price":o=e.price-t.price;break;case"availability":o=e.availability-t.availability;break}return"asc"===this.sortOrder?o:-o}))}}};const ht=(0,Ie.A)(pt,[["render",E]]);var mt=ht,ft=o(4458);(0,ft.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),(0,r.Ef)(mt).mount("#app")}},t={};function o(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,r,s,a){if(!r){var n=1/0;for(d=0;d<e.length;d++){r=e[d][0],s=e[d][1],a=e[d][2];for(var l=!0,i=0;i<r.length;i++)(!1&a||n>=a)&&Object.keys(o.O).every((function(e){return o.O[e](r[i])}))?r.splice(i--,1):(l=!1,a<n&&(n=a));if(l){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[r,s,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var s,a,n=r[0],l=r[1],i=r[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(s in l)o.o(l,s)&&(o.m[s]=l[s]);if(i)var d=i(o)}for(t&&t(r);c<n.length;c++)a=n[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(d)},r=self["webpackChunkcoursework_app"]=self["webpackChunkcoursework_app"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[504],(function(){return o(5887)}));r=o.O(r)})();
//# sourceMappingURL=app.8d1b64fb.js.map